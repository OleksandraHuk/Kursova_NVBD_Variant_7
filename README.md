ВСТУП
У процесі діяльності будь-якого підприємства значна увага приділяється управлінню персоналом. Кадрова інформація постійно змінюється: працівники приймаються на роботу, переводяться між відділами, змінюють посади та рівень оплати праці, оформлюють відпустки. У результаті з часом накопичуються великі обсяги даних, які необхідно не лише зберігати, але й аналізувати для прийняття управлінських рішень.
Облік кадрів є однією з найбільш інформаційно насичених сфер, оскільки містить як поточні дані, так і історичну інформацію за тривалий період. Для керівництва підприємства важливо мати можливість отримувати відповіді на такі питання, як структура персоналу за відділами, динаміка змін посад, плинність кадрів, використання відпусток та навантаження на працівників у різні періоди часу. Використання лише транзакційних баз даних є недостатнім для виконання складного аналізу, особливо при роботі з великими обсягами інформації.
У зв’язку з цим актуальним є застосування підходів, що поєднують класичні реляційні бази даних з технологіями сховищ даних, ETL-процесів та OLAP-аналізу. Такий підхід дозволяє відокремити оперативну обробку даних від аналічної, підвищити продуктивність запитів та забезпечити зручну роботу з історичними даними. Особливістю даної курсової роботи є робота з великими обсягами даних — не менше 500 000 записів у ключових транзакційних таблицях, що наближає розроблену систему до реальних умов використання.
Мета курсової роботи
Метою курсової роботи є розробка та реалізація інформаційної системи обліку кадрів підприємства з використанням технологій реляційних баз даних, ETL-процесів, сховищ даних та OLAP-аналізу, а також моделювання та обробка великих обсягів кадрових даних.
Завдання курсової роботи
Для досягнення поставленої мети в курсовій роботі необхідно вирішити такі завдання:
провести аналіз предметної області обліку кадрів підприємства;


визначити основні сутності, їх атрибути та зв’язки між ними;


спроєктувати концептуальну, логічну та фізичну модель бази даних;


реалізувати транзакційну базу даних для обліку кадрової інформації;


згенерувати великі обсяги тестових даних (не менше 500 000 записів);


спроєктувати та реалізувати ETL-процеси для перенесення даних у сховище даних;


побудувати OLAP-куб для аналітичної обробки кадрової інформації;


розробити аналітичні звіти для оцінки стану та динаміки персоналу.


Об’єкт і предмет дослідження
Об’єктом дослідження є процеси обліку та аналізу кадрових даних на підприємстві.
Предметом дослідження є методи та засоби проєктування баз даних, сховищ даних, ETL-процесів та OLAP-аналізу в задачах управління персоналом.
Методи дослідження
У курсовій роботі використовуються методи аналізу предметної області, моделювання даних, нормалізації реляційних баз даних, проєктування сховищ даних, а також методи багатовимірного аналізу та побудови аналітичних звітів.
Структура курсової роботи
Курсова робота складається зі вступу, чотирьох розділів, висновків, списку використаних джерел та додатків. У першому розділі наведено аналіз предметної області обліку кадрів підприємства та визначено основні об’єкти і бізнес-процеси. У другому розділі розглянуто проєктування бази даних, включаючи концептуальне, логічне та фізичне проєктування. Третій розділ присвячений реалізації ETL-процесів та формуванню сховища даних для подальшого аналітичного опрацювання. У четвертому розділі описано побудову OLAP-куба та розробку аналітичних звітів для аналізу кадрових даних. У висновках підсумовано результати виконаної курсової роботи та наведено основні отримані результати.

Аналіз предметної області  
Детальний опис обраної предметної області
Предметною областю даної курсової роботи є облік кадрів підприємства. Кадровий облік охоплює зберігання та обробку інформації про працівників, їх належність до відділів, займані посади, кадрові зміни протягом часу, а також облік відпусток різних типів. У процесі діяльності підприємства кадрові дані постійно оновлюються, а їх обсяг зростає, що зумовлює необхідність використання ефективної інформаційної системи для їх впорядкування та аналізу.
Система обліку кадрів повинна зберігати як поточний стан персоналу (активні працівники, їх посади та відділи), так і історичну інформацію, яка відображає зміни в кар’єрі працівників за тривалий період часу. До таких змін належать переведення між відділами, зміна посад, зміна рівня оплати праці, а також прийом та звільнення працівників. Окрему частину предметної області становить облік відпусток, який включає різні типи відпусток, періоди їх використання та кількість днів.
Особливістю даної предметної області є те, що за декілька років роботи підприємства накопичуються великі обсяги однотипних даних, зокрема записів про відпустки та кадрові зміни. У межах курсової роботи передбачено моделювання великих обсягів даних (понад 500 000 записів у транзакційних таблицях), що наближає розроблену систему до реальних умов експлуатації.
Виявлення та опис основних бізнес-процесів
У межах предметної області “Облік кадрів” можна виділити такі основні бізнес-процеси:
Прийом працівника на роботу, який включає створення запису працівника та фіксацію початкової посади і відділу.


Переведення працівника, що передбачає зміну посади та/або відділу з обов’язковим збереженням попередніх даних в історії посад.


Зміна умов оплати праці, зокрема зміна окладу, яка фіксується як окремий запис у кадровій історії.


Оформлення відпустки, що включає вибір типу відпустки, визначення періоду та автоматичний розрахунок кількості днів.


Контроль використання відпусток, який дозволяє аналізувати кількість використаних днів за певний період.


Звільнення працівника, що завершує кадрову історію та зберігає дані для подальшого аналізу.


Аналітичний аналіз кадрових даних, зокрема аналіз плинності кадрів, структури персоналу та використання відпусток.
Визначення функціональних вимог до системи
Інформаційна система обліку кадрів повинна забезпечувати виконання таких функцій:
зберігання довідкової інформації про відділи, посади та типи відпусток;


ведення обліку працівників із можливістю перегляду та редагування їх даних;


збереження історії кадрових змін для кожного працівника;


облік відпусток із зазначенням типу, періоду та кількості днів;


формування вибірок і звітів за працівниками, відділами, посадами та періодами часу;


забезпечення можливості подальшого аналітичного опрацювання даних у сховищі даних та OLAP-кубі.
Формулювання бізнес-правил та обмежень
Для забезпечення цілісності та коректності даних у системі вводяться такі бізнес-правила та обмеження:
Дата завершення відпустки або кадрової події не може бути меншою за дату початку.


У одного працівника не може існувати більше одного активного запису про посаду на один і той самий момент часу.


Періоди відпусток одного працівника не повинні перетинатися між собою.


Кожен запис відпустки повинен посилатися на існуючий тип відпустки.


Кожен запис історії посад повинен бути пов’язаний з існуючим працівником, посадою та відділом.


Відділ може мати керівника, яким є один із працівників підприємства.


Концептуальне проектування 
У межах виконання курсової роботи мною було проведено концептуальне проектування бази даних для предметної області «Облік кадрів». На даному етапі я зосередилась на визначенні основних сутностей предметної області, їх атрибутів, а також на встановленні зв’язків між цими сутностями.
Для наочного відображення структури предметної області я побудувала ER-діаграму з використанням нотації Crow’s Foot. Побудована ER-діаграма дозволяє візуалізувати основні об’єкти системи кадрового обліку та логічні зв’язки між ними.


Рисунок 1 – ER-діаграма предметної області «Облік кадрів» бази даних 7var

Опис сутностей предметної області
Центральною сутністю спроєктованої системи є сутність «Працівник» (Employees). На етапі концептуального проєктування я визначила, що саме ця сутність є основною для всієї системи кадрового обліку, оскільки з нею пов’язані більшість інших об’єктів предметної області. Для кожного працівника в системі зберігається унікальний ідентифікатор, табельний номер, адреса проживання, а також посилання на відділ, посаду та персональні (паспортні) дані. Саме через сутність «Працівник» реалізується зв’язок між організаційною структурою підприємства та кадровими подіями.
Для опису організаційної структури підприємства я виділила сутність «Відділ» (Departments). Дана сутність використовується для зберігання інформації про структурні підрозділи підприємства. Для кожного відділу зберігається унікальний ідентифікатор, назва, скорочена назва та інформація про керівника. Використання окремої сутності для відділів дозволяє аналізувати кадровий склад підприємства в розрізі структурних підрозділів та уникнути дублювання даних.
Сутність «Посада» (Positions) була виділена як довідникова. Вона містить перелік посад, які існують на підприємстві, та використовується для уніфікації назв посад у системі. Для кожної посади зберігається унікальний ідентифікатор, назва, базовий оклад та коефіцієнт оплати праці. Виділення цієї сутності в окрему таблицю дозволяє централізовано керувати інформацією про посади та використовувати її як у поточному кадровому обліку, так і в аналітичних розрахунках.
Для збереження персональних та ідентифікаційних даних працівників я передбачила окрему сутність «Паспортні дані» (Passport_Data / data_Passport). Вона містить такі атрибути, як прізвище, ім’я, по батькові, паспортні дані, дата та місце народження. Виділення персональних даних в окрему сутність дозволяє уникнути надлишковості інформації та підвищує логічну структурованість бази даних.
Для збереження інформації про кадрові зміни я ввела сутність «Історія посад» (History_Position). На цьому етапі я визначила, що саме через цю сутність повинні зберігатися всі зміни, пов’язані з посадою працівника у часі. Кожен запис історії посад містить ідентифікатор працівника, ідентифікатор посади, а також дати початку та завершення дії відповідної посади. Це дозволяє відстежувати кар’єрний шлях працівника та відновлювати стан кадрового складу підприємства на будь-який момент часу.
Для обліку відпусток працівників я виділила сутність «Відпустка» (Holidays). Вона містить інформацію про період відпустки, зокрема дату початку та дату завершення. Кожна відпустка обов’язково пов’язана з конкретним працівником, що забезпечує коректний облік використання відпусток та дозволяє аналізувати відпускну активність персоналу.
Опис зв’язків між сутностями
Під час концептуального проєктування я визначила основні зв’язки між сутностями предметної області відповідно до логіки кадрового обліку.
Один працівник може мати декілька записів в історії посад, оскільки протягом трудової діяльності він може змінювати посаду. Водночас кожен запис історії посад належить лише одному працівнику та одній посаді. Такий підхід дозволяє зберігати повну історію кадрових змін без втрати даних.
Один відділ може включати багато працівників, проте кожен працівник у поточний момент часу належить лише до одного відділу. Інформація про зміну відділів у часі опосередковано аналізується через історію посад, що дозволяє уникнути дублювання даних у поточній таблиці працівників.
Також я визначила, що один працівник може мати декілька відпусток, оскільки відпустки надаються у різні періоди часу. Водночас кожна відпустка належить лише одному працівнику та має чітко визначені дати початку і завершення. Це забезпечує коректний облік використання відпускних періодів.
Сутність паспортних даних пов’язана з сутністю працівників зв’язком «один-до-одного», оскільки кожен працівник має один набір персональних даних, який використовується для його ідентифікації в системі.
Логічне проектування
На етапі логічного проектування я виконала нормалізацію бази даних з метою усунення надлишковості та забезпечення цілісності даних. У процесі проєктування структура бази даних була приведена до третьої нормальної форми (3НФ), що відповідає класичним вимогам до побудови реляційних баз даних.
Я забезпечила, щоб усі таблиці містили атомарні значення атрибутів, тобто кожне поле зберігало лише одне логічне значення. Таким чином була виконана перша нормальна форма. Для другої нормальної форми я усунула часткові залежності, винісши атрибути, які не залежать від первинного ключа таблиці, в окремі сутності. Зокрема, інформація про відділи, посади та паспортні дані була винесена в окремі таблиці.
Третя нормальна форма була досягнута шляхом усунення транзитивних залежностей. Усі неключові атрибути залежать виключно від первинного ключа відповідної таблиці. Наприклад, інформація про керівника відділу зберігається у таблиці відділів, а не дублюється у таблиці працівників, що забезпечує логічну узгодженість структури даних.
Обґрунтування денормалізації
На етапі логічного проектування денормалізація бази даних не застосовувалася. Я дійшла висновку, що нормалізована структура повністю задовольняє вимоги предметної області та є оптимальною для транзакційної обробки кадрових даних.
Застосування денормалізації було свідомо перенесене на рівень сховища даних (Data Warehouse), де використовується схема «зірки». Такий підхід дозволяє зберегти чисту та логічно коректну OLTP-модель, одночасно забезпечуючи високу продуктивність аналітичних запитів у DW та OLAP-кубі.
Визначення первинних та зовнішніх ключів
У ході логічного проектування я визначила первинні та зовнішні ключі для всіх таблиць бази даних. Первинні ключі використовуються для однозначної ідентифікації кожного запису в таблицях та забезпечують унікальність даних.
У таблицях Employees, Departments, Positions, Holidays, History_Position та Passport_Data первинні ключі представлені у вигляді унікальних ідентифікаторів. Зовнішні ключі реалізують зв’язки між таблицями відповідно до концептуальної моделі. Наприклад, зовнішні ключі використовуються для зв’язку працівників з відділами, посадами, відпустками та історією посад.
Застосування первинних і зовнішніх ключів дозволяє забезпечити референтну цілісність даних та запобігти виникненню логічних помилок у базі даних.
Проєктування індексів для оптимізації запитів
Для підвищення продуктивності виконання запитів я спроєктувала індекси для найбільш використовуваних полів. Зокрема, індекси були створені для первинних ключів та зовнішніх ключів, які часто використовуються у з’єднаннях таблиць.
Також індекси доцільно застосовувати до полів, які використовуються у фільтрації та сортуванні даних, наприклад за ідентифікатором працівника або датами відпусток. Це дозволяє зменшити час виконання запитів та підвищити загальну продуктивність системи кадрового обліку.
Фізичне проектування
На етапі фізичного проектування я реалізувала логічну модель бази даних у середовищі Microsoft SQL Server. Для створення структури бази даних були розроблені SQL-скрипти, які визначають таблиці, їх атрибути та типи даних.
Створення OLTP-бази даних виконано за допомогою SQL-скрипта CREATE_DATABASE.sql, у якому описано створення всіх основних таблиць відповідно до логічної моделі. Аналогічно для сховища даних був підготовлений окремий скрипт CREATE_DW.sql, який містить опис таблиць фактів і вимірів.

CREATE DATABASE 7var;
GO
USE [7var];
GO

CREATE TABLE data_Passport (
    id INT IDENTITY(1,1) PRIMARY KEY,
    father_name VARCHAR(50) NOT NULL,
    name VARCHAR(50) NOT NULL,
    surname VARCHAR(50) NOT NULL,
    passport_data INT NOT NULL,
    date_of_birth DATE NOT NULL,
    place_of_birth VARCHAR(50) NOT NULL
);

CREATE TABLE Departments (
    id INT IDENTITY(1,1) PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    abbreviation VARCHAR(4) NOT NULL,
    manager_name VARCHAR(50) NOT NULL
);

CREATE TABLE Positions (
    id INT IDENTITY(1,1) PRIMARY KEY,
    name VARCHAR(32) NOT NULL,
    salary INT NOT NULL,
    rate DECIMAL(10,2) NOT NULL
);

CREATE TABLE Employees (
    id INT IDENTITY(1,1) PRIMARY KEY,
    id_passport INT NOT NULL,
    report_number INT NOT NULL,
    home_address VARCHAR(50) NOT NULL,
    id_departament INT NOT NULL,
    position INT NOT NULL,
    FOREIGN KEY (id_departament) REFERENCES Departments(id),
    FOREIGN KEY (position) REFERENCES Positions(id),
    FOREIGN KEY (id_passport) REFERENCES data_Passport(id)
);

CREATE TABLE History_Position (
    id INT IDENTITY(1,1) PRIMARY KEY,
    id_empoyee INT NOT NULL,
    id_position INT NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NULL,
    FOREIGN KEY (id_empoyee) REFERENCES Employees(id),
    FOREIGN KEY (id_position) REFERENCES Positions(id)
);

CREATE TABLE Holidays (
    id INT IDENTITY(1,1) PRIMARY KEY,
    id_employee INT NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NULL,
    FOREIGN KEY (id_employee) REFERENCES Employees(id)
);
GO


CREATE DATABASE varDW;
GO
USE varDW;
GO

CREATE TABLE Dim_Employee (
    employee_id INT IDENTITY(1,1) PRIMARY KEY,
    full_name VARCHAR(155),
    date_of_birth DATE,
	place_of_birth VARCHAR(50) NOT NULL,
	passport_data INT NOT NULL,
	report_number INT NOT NULL,
    home_address VARCHAR(50),
	employee_key INT NOT NULL
);

CREATE TABLE Dim_Department (
    department_id INT IDENTITY(1,1) PRIMARY KEY,
    name VARCHAR(50),
    abbreviation VARCHAR(4),
    manager_name VARCHAR(50),
	department_key INT NOT NULL
);

CREATE TABLE Dim_Position (
    position_id INT IDENTITY(1,1) PRIMARY KEY,
    name VARCHAR(50),
    base_salary INT,
    rate DECIMAL(10,2),
	position_key INT NOT NULL
);

CREATE TABLE Dim_Date (
    date_id INT IDENTITY(1,1) PRIMARY KEY,
    date DATE NULL,
    year INT NULL,
    month INT NULL,
    day INT NULL
);
CREATE TABLE Fact_Personnel (
    fact_id INT IDENTITY(1,1) PRIMARY KEY,
    employee_id INT,
    department_id INT,
    position_id INT,
    holiday_start_date_id INT,
    holiday_end_date_id INT NULL,
    work_start_date_id INT,
    work_end_date_id INT NULL,
	vacation_days INT DEFAULT 0,
    total_salary DECIMAL(15,2),
	FOREIGN KEY (holiday_start_date_id) REFERENCES Dim_Date(date_id), 
    FOREIGN KEY (holiday_end_date_id) REFERENCES Dim_Date(date_id),   
    FOREIGN KEY (work_start_date_id) REFERENCES Dim_Date(date_id),    
    FOREIGN KEY (work_end_date_id) REFERENCES Dim_Date(date_id),
    FOREIGN KEY (employee_id) REFERENCES Dim_Employee(employee_id),
    FOREIGN KEY (department_id) REFERENCES Dim_Department(department_id),
    FOREIGN KEY (position_id) REFERENCES Dim_Position(position_id)
);
GO

Для забезпечення цілісності даних я реалізувала набір обмежень на рівні бази даних. Первинні ключі забезпечують унікальність кожного запису, а зовнішні ключі — коректність зв’язків між таблицями.
Обмеження типу FOREIGN KEY використовуються для зв’язку працівників з відділами, посадами, відпустками та історією посад. Обмеження UNIQUE застосовуються для полів, значення яких не повинні повторюватися, наприклад табельних номерів працівників. Обмеження CHECK використовуються для контролю допустимих значень атрибутів, зокрема для перевірки коректності дат початку та завершення відпусток.
Для реалізації складніших бізнес-правил, які неможливо повністю забезпечити стандартними обмеженнями, я передбачила використання тригерів. Тригери дозволяють автоматично перевіряти коректність операцій вставки та оновлення даних у таблицях.
Зокрема, тригери можуть використовуватися для контролю періодів дії посад або перевірки логіки дат у записах історії посад і відпусток. Такий підхід дозволяє додатково захистити базу даних від некоректних змін.
Для інкапсуляції бізнес-логіки роботи з даними я передбачила використання збережених процедур та функцій. Вони дозволяють централізувати доступ до даних, спростити виконання типових операцій та підвищити безпеку системи.
Генерація та наповнення даних
Після створення структури бази даних мною було виконано її наповнення тестовими даними за допомогою інструменту Redgate SQL Data Generator. Використання даного засобу дозволило автоматизовано згенерувати значні обсяги реалістичних даних із дотриманням визначених обмежень цілісності та зв’язків між таблицями.
У процесі генерації даних я налаштувала правила наповнення для кожної таблиці з урахуванням специфіки предметної області. Зокрема, було забезпечено коректну прив’язку працівників до відділів і посад, формування історичних записів про зміну посад, а також генерацію записів про відпустки за різні часові періоди. Це дозволило змоделювати реальне функціонування системи обліку кадрів протягом тривалого часу.
Після завершення генерації даних я провела перевірку результатів шляхом виконання контрольних SQL-запитів, які підтвердили коректність наповнення таблиць та відповідність кількості записів вимогам до надвеликих баз даних

Обґрунтування використання сховища даних
У процесі виконання курсової роботи я проаналізувала можливості використання транзакційної OLTP-бази даних для аналітичних задач і дійшла висновку, що така база не є оптимальною для виконання складних аналітичних запитів. OLTP-база даних орієнтована на швидке виконання операцій вставки, оновлення та видалення даних, однак вона не забезпечує достатньої продуктивності при виконанні агрегацій, аналізі історичних даних та багатовимірному аналізі.
З цієї причини я прийняла рішення про створення окремого сховища даних (Data Warehouse), яке дозволяє зберігати історичну інформацію в узгодженому вигляді та оптимізувати структуру даних для аналітичної обробки. Використання сховища даних дає змогу відокремити операційне навантаження від аналітичного та підвищити загальну ефективність роботи системи.
Вибір архітектури сховища даних
На етапі проектування сховища даних я обрала архітектуру зірки (Star Schema). Такий підхід є одним з найпоширеніших для побудови аналітичних систем, оскільки він забезпечує простоту структури, високу швидкість виконання запитів та зручність побудови OLAP-кубів.
Схема «зірки» передбачає наявність центральної таблиці фактів, яка містить числові показники для аналізу, та набору таблиць вимірів, що описують контекст цих показників. Обрана архітектура дозволяє ефективно аналізувати кадрові дані в розрізі часу, працівників, відділів та посад.

Рисунок 2 – ER-діаграма предметної області «Облік кадрів» бази даних varDW
Центральним елементом сховища даних є таблиця фактів Fact_Personnel. У цій таблиці зберігається узагальнена інформація про кадрові події та показники, які підлягають подальшому аналізу.
Таблиця фактів містить зовнішні ключі на відповідні таблиці вимірів, а також числові показники, які можуть агрегуватися. Основним призначенням таблиці Fact_Personnel є забезпечення можливості аналізу кадрової інформації у різних розрізах.
У таблиці Fact_Personnel зберігаються такі атрибути:
ідентифікатор факту;


ідентифікатор працівника;


ідентифікатор відділу;


ідентифікатор посади;


ідентифікатори дат початку та завершення відпустки;


ідентифікатори дат початку та завершення роботи на посаді;


кількість днів відпустки;


загальна сума заробітної плати.


Такий набір атрибутів дозволяє виконувати комплексний аналіз кадрових даних та формувати аналітичні показники для подальшої обробки в OLAP-кубі.
Вимір «Працівник» (Dim_Employee)
Таблиця виміру Dim_Employee призначена для зберігання узагальненої інформації про працівників. Вона містить ключ виміру, повне ім’я працівника, дату народження, місце народження, табельний номер та адресу проживання.
Використання окремого виміру працівників дозволяє виконувати аналіз кадрових показників у розрізі конкретних працівників та їх персональних характеристик.
Вимір «Відділ» (Dim_Department)
Таблиця Dim_Department використовується для зберігання інформації про структурні підрозділи підприємства. Вона містить назву відділу, скорочену назву та інформацію про керівника.
Даний вимір дозволяє аналізувати кадрові показники в розрізі відділів та оцінювати кадрову ситуацію в кожному структурному підрозділі.
Вимір «Посада» (Dim_Position)
Таблиця Dim_Position містить інформацію про посади, включаючи назву посади, базовий оклад та коефіцієнт оплати праці. Цей вимір використовується для аналізу кадрових показників залежно від посад та рівнів оплати праці.
Вимір «Час» (Dim_Date)
Вимір Dim_Date призначений для аналізу даних у часовому розрізі. Таблиця містить атрибути дати, року, місяця та дня. Використання окремого часового виміру дозволяє виконувати аналіз динаміки кадрових показників за різні періоди часу.
Взаємозв’язок таблиць у сховищі даних
Усі таблиці вимірів пов’язані з таблицею фактів Fact_Personnel за допомогою зовнішніх ключів. Такий підхід забезпечує цілісність даних та дозволяє виконувати багатовимірний аналіз кадрової інформації.
Сформована структура сховища даних повністю відповідає вимогам аналітичної обробки та є основою для подальшої побудови OLAP-куба.
Реалізація ETL-процесів
На даному етапі курсової роботи я здійснила створення проєкту ETL-процесів з використанням технології SQL Server Integration Services (SSIS). Для цього у середовищі Visual Studio з встановленими SQL Server Data Tools (SSDT) було створено новий проєкт типу Integration Services Project.
У межах проєкту я налаштувала підключення до джерельної OLTP-бази даних, яка містить інформацію про працівників, відділи, посади, відпустки та історію посад. Також було налаштовано з’єднання з базою даних сховища (Data Warehouse), у яку завантажуються очищені та трансформовані дані.
Налаштування з’єднань виконано за допомогою компонентів OLE DB Connection Manager, що забезпечує стабільний доступ до обох баз даних та можливість подальшої автоматизації процесів завантаження

Рисунок 3.1 – Проєкт SSIS
На етапі витягування даних (Extract) я налаштувала отримання інформації з OLTP-бази даних. Для цього у SSIS-пакеті було використано компонент OLE DB Source, який дозволяє виконувати SQL-запити до джерельних таблиць.
У процесі витягування я отримувала дані з таблиць працівників, відділів, посад, відпусток та історії посад. Дані витягуються у початковому вигляді та передаються до наступних етапів трансформації без змін.
Реалізація процесу Transform
Етап трансформації є ключовим у реалізації ETL-процесів. Саме на цьому етапі я виконала очищення, перетворення та підготовку даних до завантаження у сховище даних.
У процесі трансформації мною були використані такі компоненти SSIS:
Lookup — для зв’язування даних з таблицями вимірів та отримання сурогатних ключів;


Derived Column — для створення обчислюваних атрибутів та підготовки даних у необхідному форматі;


Data Conversion — для приведення типів даних до відповідних типів у сховищі даних;


Conditional Split — для розділення коректних та некоректних записів (за потреби).


Використання зазначених трансформацій дозволило забезпечити цілісність, узгодженість та коректність даних перед їх завантаженням у таблицю фактів.


Рисунок 3.2 – Деплой Fact_Personnel
На етапі завантаження даних (Load) підготовлені та трансформовані дані були записані у відповідні таблиці сховища даних. Для цього я використала компонент OLE DB Destination, який забезпечує ефективне масове завантаження даних.
Завантаження виконувалося у таблицю фактів Fact_Personnel, а також у таблиці вимірів. Під час налаштування завантаження було враховано відповідність типів даних та ключових полів, що дозволило уникнути помилок під час виконання пакета.

У результаті реалізації ETL-процесів було забезпечено автоматизоване витягування, трансформацію та завантаження кадрових даних зі структури OLTP-бази у сховище даних. Реалізований ETL-процес є стабільним, відтворюваним та готовим до використання в аналітичних системах і OLAP-куб

Побудова OLAP-куба (SQL Server Analysis Services) 
На даному етапі курсової роботи я здійснила побудову OLAP-куба з використанням технології SQL Server Analysis Services (SSAS). Для цього у середовищі Visual Studio було створено новий проєкт типу Analysis Services Multidimensional and Data Mining Project.
Після створення проєкту я налаштувала підключення до сховища даних, яке було сформоване на попередньому етапі за допомогою ETL-процесів. Підключення до бази даних сховища дозволяє використовувати таблиці фактів і вимірів як джерело даних для OLAP-куба

Рисунок 4.1 – Проєкт OLAP-куба у середовищі Visual Studio
Після створення проєкту я налаштувала Data Source, який визначає параметри підключення до сховища даних. У якості джерела даних було використано базу даних Data Warehouse, що містить таблицю фактів Fact_Personnel та відповідні таблиці вимірів.
На основі Data Source було створено Data Source View (DSV), який відображає логічну модель даних, що використовується в OLAP-кубі. У DSV були включені всі необхідні таблиці фактів і вимірів, а також перевірені зв’язки між ними
На наступному етапі я виконала проектування структури OLAP-куба. Центральним елементом куба є таблиця фактів Fact_Personnel, яка містить числові показники для аналізу. На її основі було створено групу мір (Measure Group).
До куба були підключені виміри Dim_Employee, Dim_Department, Dim_Position та Dim_Date, які визначають контекст аналізу фактних даних. Така структура дозволяє виконувати багатовимірний аналіз кадрової інформації у різних розрізах.

Рисунок 4.2 – Структура OLAP-куба
На етапі проектування структури OLAP-куба я проаналізувала структуру сховища даних та визначила, що для повноцінного аналітичного аналізу кадрової інформації доцільно використовувати дві таблиці фактів, які відображають різні аспекти предметної області.
Першою таблицею фактів є Fact_Personnel, яка містить узагальнені кадрові показники та використовується для аналізу кількості працівників, розподілу персоналу за відділами та посадами, а також для оцінки кадрової структури підприємства у різні часові періоди.
Другою таблицею фактів є Fact_Holidays, яка призначена для аналізу інформації, пов’язаної з відпустками працівників. Дана таблиця фактів містить показники, що дозволяють аналізувати тривалість відпусток, їх кількість та динаміку використання відпускних періодів у часовому розрізі.
Обидві таблиці фактів пов’язані з відповідними таблицями вимірів, зокрема Dim_Employee, Dim_Department, Dim_Position та Dim_Date, що забезпечує можливість виконання багатовимірного аналізу даних у єдиному OLAP-кубі. Кожна таблиця фактів формує окрему групу мір (Measure Group), що дозволяє аналізувати кадрові показники та показники відпусток незалежно або у взаємозв’язку між собою.
Визначення мір OLAP-куба
На даному етапі я виконала визначення та налаштування мір OLAP-куба на основі двох таблиць фактів, які використовуються у сховищі даних. Кожна таблиця фактів формує окрему групу мір (Measure Group), що дозволяє аналізувати різні аспекти предметної області в межах одного OLAP-куба.
Міри на основі таблиці фактів Fact_Personnel
Таблиця фактів Fact_Personnel використовується для аналізу кадрової структури підприємства. На її основі мною були визначені такі основні міри:
Кількість працівників — міра типу Count, яка дозволяє визначати загальну кількість працівників у розрізі відділів, посад та часових періодів;


Сума заробітної плати — міра типу Sum, що використовується для аналізу фонду оплати праці за різні періоди часу;


Середня заробітна плата — обчислювана міра, яка дозволяє оцінювати середній рівень оплати праці залежно від посади, відділу або періоду.


Зазначені міри дозволяють аналізувати кадрові показники підприємства, оцінювати розподіл персоналу та динаміку змін у кадровому складі.
Міри на основі таблиці фактів Fact_Holidays
Таблиця фактів Fact_Holidays використовується для аналізу інформації про відпустки працівників. На її основі мною були визначені такі міри:
Кількість відпусток — міра типу Count, яка дозволяє аналізувати кількість відпусток у різних розрізах;


Кількість днів відпустки — міра типу Sum, що використовується для аналізу загальної тривалості відпусток;


Середня тривалість відпустки — обчислювана міра, яка дозволяє оцінювати середню кількість днів відпустки на одного працівника.


Дані міри забезпечують можливість детального аналізу використання відпусток у часовому розрізі, а також порівняння показників між різними відділами та категоріями працівників.
Спільне використання мір та вимірів
Обидві групи мір використовують спільні таблиці вимірів, зокрема Dim_Employee, Dim_Department, Dim_Position та Dim_Date. Це дозволяє виконувати комплексний аналіз кадрових показників та показників відпусток у єдиному аналітичному просторі.
Використання двох таблиць фактів у межах одного OLAP-куба забезпечує гнучкість аналітичної моделі та дозволяє досліджувати взаємозв’язок між кадровою структурою підприємства та використанням відпусток.
 Обробка, розгортання та тестування OLAP-куба
Після завершення налаштування структури OLAP-куба, вимірів та мір я виконала його обробку та розгортання у середовищі SQL Server Analysis Services. Процес розгортання включав перевірку коректності підключення до сховища даних, відповідності структури куба таблицям фактів і вимірів, а також налаштувань груп мір.
Під час обробки куба було виконано завантаження даних з таблиць фактів Fact_Personnel та Fact_Holidays у відповідні групи мір. Обробка завершилася без помилок, що підтвердило коректність налаштування структури куба та узгодженість даних у сховищі.
Після успішного розгортання я провела тестування OLAP-куба шляхом виконання аналітичних запитів та перегляду результатів агрегації мір у різних розрізах. Результати тестування підтвердили коректність обчислення мір, правильну роботу ієрархій вимірів та можливість багатовимірного аналізу кадрових даних і даних про відпустки.
Таким чином, OLAP-куб було успішно розгорнуто та підготовлено до практичного використання для аналітичних задач.



СПИСОК ВИКОРИСТАНИХ ДЖЕРЕЛ
Microsoft. SQL Server Documentation. — Available at: https://learn.microsoft.com/sql
Microsoft. SQL Server Integration Services (SSIS) Documentation. — Available at: https://learn.microsoft.com/sql/integration-services
Microsoft. SQL Server Analysis Services (SSAS) Documentation. — Available at: https://learn.microsoft.com/sql/analysis-services
Microsoft. Data Warehouse Design Concepts. — Available at: https://learn.microsoft.com/azure/architecture/data-guide/relational-data/data-warehousing
Redgate Software. SQL Data Generator Documentation. — Available at: https://www.red-gate.com/products/sql-development/sql-data-generator
Silberschatz A., Korth H., Sudarshan S. Database System Concepts. — McGraw-Hill, 2011.
Connolly T., Begg C. Database Systems: A Practical Approach to Design, Implementation, and Management. — Pearson, 2015.


